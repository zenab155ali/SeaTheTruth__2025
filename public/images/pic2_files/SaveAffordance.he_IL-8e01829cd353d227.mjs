"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[47442],{243789:(e,t,a)=>{a.r(t),a.d(t,{default:()=>R});var n=a(667294),i=a(545007),o=a(883119),s=a(812696),l=a(281584),r=a(609326),c=a(602185),_=a(636565),d=a(144326),u=a(297728),p=a(770975);function m({constraint:e}){let t=(0,p.E)(),a=t?.getId();return(0,n.useEffect)(()=>{t&&t.markConstraintComplete(e)},[a,e]),null}var v=a(587755),f=a(750077),h=a(864723),S=a(154785),b=a(969119),g=a(383399),y=a(273777),E=a(897791),A=a(207462),I=a(345020),k=a(948324),w=a(785893);let C=(0,k.Z)(()=>a.e(43473).then(a.bind(a,396261)),void 0,e=>396261,"PinSaveButtonCommon"),x=(0,n.lazy)(async()=>({default:(await Promise.all([a.e(69965),a.e(22538)]).then(a.bind(a,877508))).QuickSaveButtonWithExperienceAnchor})),R=({boardCount:e=0,clientTrackingParams:t,fromEggsBoard:a,onBoardSelectionFlyoutChange:k,onClickCallback:R,pin:P,showEnabledSaveBehavior:T,showRepinOnInitialRender:Z,variant:U,viewParameter:D,viewType:N})=>{let B=(0,p.E)(),{experience:j}=(0,_.Ow)(1000310),{checkExperiment:O}=(0,u.F)(),{experience:M}=(0,_.Ow)(12),L=(0,S.Z)(),Q=(0,i.I0)(),K=(0,d.ZP)(),z=(0,g.Z)(),F=(0,n.useRef)(!1),{pins:G,clear:H}=(0,E.Z)(),W=(0,h.M0)().getItem(r.M8)||"",$=W?W===P.id:!!G&&G.length>0&&G[G.length-1].id===P.id;(0,b.Z)(()=>{F.current||2!==G.length&&(1!==G.length||$)||(F.current=!0,(2===G.length&&!W&&$?[G[0]]:G).forEach(({id:e,nodeId:t})=>{(0,l.Z)({description:"",entityId:e,link:"",promotedIsRemovable:void 0,title:""},K).then(a=>{let{id:n,url:i,name:o}=a;Q((0,A.d)({boardId:n,url:i,title:o||"",pinId:e||"",nodeId:t}))})}),$||H())});let V=z.isAuth&&O("web_curation_brv_navigate_to_board_from_closeup").anyEnabled,q=()=>{(0,h.M0)().removeItem(r.M8),H(),L({action:"trigger",item:"unauth-save-button-quicksave"}),Q((0,I.hT)(!0)),Q((0,A.d)({boardId:"",url:"",title:"Profile",pinId:P.id,nodeId:P?.node_id})),Q((0,A.X)(P))},X=()=>{(0,v.Nx)("button"),B&&B.markConstraintComplete("button")};if(P?.pinner?.blocked_by_me||P?.promoted_is_removable)return(0,v.Nx)("button"),(0,w.jsx)(m,{constraint:"button"});if(j&&502450===j.experience_id)return(0,w.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_QuickSaveButton",children:(0,w.jsx)(f.Z,{children:(0,w.jsx)(x,{autoQuicksaveCallback:q,clientTrackingParams:t,experience:j,onClickCallback:R,onMount:X,pinKey:{type:"deprecated",data:P},shouldAutoQuicksave:$,showEnabledSaveBehavior:T,viewParameter:D})})});let J=!P.content_sensitivity?.is_sensitive_content&&void 0!==e,Y=[501041],ee=M&&501041===M.experience_id&&M.display_data.has_tooltip?e=>(0,w.jsx)(_.Qp,{anchor:e,experienceIds:Y,idealDirection:"down",placementId:12,positionRelativeToAnchor:!0,showCaret:!0}):e=>(0,w.jsx)(_.N,{anchors:{3010:e},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0});return J?(0,w.jsx)(o.xu,{children:(0,w.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_PinBetterSave",children:(0,w.jsx)(y.default,{autoQuicksaveCallback:q,clientTrackingParams:t,fromEggsBoard:a,onClickCallback:R,onMount:X,onToggleFlyout:k,pinKey:{type:"deprecated",data:P},renderPinSaveTooltip:ee,renderSavedStatus:V?({savedInfo:e,showBoardFlyout:t,handleBoardDropdownClick:a})=>(0,w.jsx)(s.Z,{accessibilityLabel:K.bt("בחרו לוח אשר ברצונכם לשמור בו", "Select a board you want to save to", "Closeup.BoardSelection.SplitSaveButton", undefined, true),isSaved:!0,onClick:a,selectedItem:e,showBoardFlyout:t}):void 0,shouldAutoQuicksave:$,variant:U,viewParameter:D,viewType:N})})}):(0,w.jsx)(c.Z,{name:"SafeSuspense_SaveAffordance_PinSaveButton",children:(0,w.jsx)(f.Z,{children:(0,w.jsx)(C,{clientTrackingParams:t,isCloseupPin:!0,onClickCallback:R,onMount:X,pinKey:{type:"deprecated",data:P},renderPinSaveTooltip:ee,showRepinOnInitialRender:Z})})})}},456082:(e,t,a)=>{a.d(t,{i:()=>i,x:()=>o});var n=a(267005);let i=["shopping_rec_disabled","featureMap","comments_disabled","allow_mentions","messaging_permissions","opt_in_private_account","ads_customize_from_conversion","personalize_from_offsite_browsing","third_party_marketing_tracking_enabled","ccpa_opted_out","third_party_ads_personalization","video_rec_enabled"];function o({apiErrorCode:e,onShowMessage:t,onPassCodeRequired:a,onPassCodeSkipConfirmation:i}){e&&(({[n.RR]:t,[n.mX]:a,[n.q6]:i})[e]||t)()}},278762:(e,t,a)=>{a.d(t,{Z:()=>i});var n=a(252071);let i=e=>n.Z.create("UserPasswordResource",e).callUpdate({showError:!1})},897791:(e,t,a)=>{a.d(t,{$:()=>r,Z:()=>d});var n=a(609326),i=a(192820),o=a(297728),s=a(864723),l=a(166408);let r=2,c=e=>e?.pins??[],_=e=>e.length?{pins:e}:null,d=()=>{let e;let t=(0,s.M0)(),a=c(t.accessAllowed?t.getItem(n.s1):l.ZP.getItem(i.w3)),d=e=>t.accessAllowed?t.setItem(n.s1,_(e)):l.ZP.setItem(i.w3,_(e)),{checkExperiment:u}=(0,o.F)(),p=u("mweb_block_unauth_save").group;if(p.startsWith("enabled")){let[,t]=p.split("_");e=Number(t)}else e=r;let m=()=>a.length<e;return{pins:a,save:e=>{m()&&d(a.filter(({id:t})=>t!==e.id).concat([e]))},unsave:e=>d(a.filter(({id:t})=>t!==e)),isSaved:e=>a.some(({id:t})=>t===e),clear:()=>d([]),canSaveMore:m}}},345020:(e,t,a)=>{a.d(t,{Cp:()=>v,GT:()=>c,V6:()=>l,W2:()=>d,W6:()=>f,_L:()=>m,fm:()=>r,hT:()=>_});var n=a(252071),i=a(456082),o=a(278762),s=a(468808);function l(e,t){return{type:"UPDATE_USER_SOCIAL_NETWORK",payload:{socialNetworkName:e,connected:t}}}let r=e=>({type:"USER_DOMAIN_VERIFIED",payload:{verifiedWebsite:e}}),c=e=>({type:"USER_DOMAIN_UNVERIFIED",payload:{verifiedWebsite:e}});function _(e){return{type:"UPDATE_HAS_QUICKSAVE_BOARD",payload:{createdQuicksaveBoard:e}}}let d=(e,t,a)=>n=>{n({type:"USER_SETTING_CHANGE",payload:{id:e,field:t,value:a}})},u=(e,t,a)=>n=>{n({type:"USER_PARTNER_SETTING_CHANGE",payload:{id:e,field:t,value:a}})},p=e=>{let t=e.split(" ");return{first_name:t[0],last_name:t[1]}},m=({field:e,value:t,passcode:a,onSettingSavedHn:o,showErrorHn:l,surfaceTag:r,userId:c,passcodeSkipAcknowledged:_=!1,otp:m,onFinallyHn:v})=>async(f,h)=>{let S=h().users[c],b={user_id:c,surface_tag:r};if("full_name"===e){if(S.is_partner)b.business_name=t;else{let e=p(t);b.first_name=e.first_name,b.last_name=e.last_name||""}}else b[e]=t;a&&(b.passcode=a),i.i.includes(e)&&null!=_&&(b.user_confirm_skip_passcode=_),m&&(b.otp=m);try{let a=await n.Z.create("UserSettingsResource",b).callUpdate();if("email"===e&&a?.resource_response.data?.email_changing_to){l({email_changing_to:a.resource_response.data.email_changing_to});return}if("profile_image_url"===e)f((0,s.b)("UserResource",{options:b}));else if("full_name"===e){if(S.is_partner)f(d(c,"first_name",t));else{let e=p(t);f(d(c,"first_name",e.first_name)),f(d(c,"last_name",e.last_name))}}f(S.is_partner&&("account_type"===e||"contact_name"===e)?u(c,e,t):d(c,e,t)),o()}catch(e){l(e)}finally{v?.()}},v=(e,t,a,n,i,s,l)=>()=>{(0,o.Z)({new:t,new_confirm:a,old:e,passcode:n,recaptcha_v3_token:i}).then(s,l)},f=(e,t,a,i,o,s)=>l=>{l(d(e,`${t}.${a}`,i));let r={},c="EmailSettingsResource";void 0!==o?(r={section:t,option:a,value:i,od:o.od,user_id:o.user_id},c="UnsubEmailSettingsResource"):r={section:t,option:a,value:i},n.Z.create(c,r).callUpdate().then(s).catch(()=>l(d(e,`${t}.${a}`,!i)))}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/SaveAffordance.he_IL-8e01829cd353d227.mjs.map